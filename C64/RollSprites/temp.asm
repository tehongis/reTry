    org $0801
basic:
    ; 2022 SYS2064
    db  $0b, $08, $e6, $07, $9e, $32, $30, $36, $34, $00, $00
     
    org $0810
init:
    lda #$00
    sta $d020
    lda #$00
    sta $d021

    ldx #$00
.charloop
    lda #$3f
    sta $0400,x
    sta $0480,x
    sta $0500,x
    sta $0580,x
    sta $0600,x
    sta $0680,x
    sta $0700,x
    sta $0780,x
    inx
    cpx #$80
    bne .charloop

    ldx #$00
    lda #$00
.colorloop
    sta $d800,x
    sta $d840,x
    sta $d880,x
    sta $d8c0,x
    sta $d900,x
    sta $d940,x
    sta $d980,x
    sta $d9c0,x
    sta $da00,x
    sta $da40,x
    sta $da80,x
    sta $dac0,x
    sta $db00,x
    sta $db40,x
    sta $db80,x
    sta $dbc0,x
    inx
    cpx #$40
    bne .colorloop

    lda #$21
    sta $ff


    lda #$00
    jsr music

    sei
    lda #$35
    sta $01

    lda #<irq
    sta $fffe
    lda #>irq
    sta $ffff

    lda #$7f
    sta $dc0d
    lda #$01
    sta $d01a

    lda #$32
    sta $d012
    lda #$1b
    sta $d011
    cli

.idleloop
    jmp .idleloop


irq:
    lda #$01
    sta $d019

    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop

    ldy #$00
.outloop
    ldx linelocations,y
    stx $d020
    lda linecolors,y
    sta $d021

    txa
    cmp #$00
    beq .moverow

    ldx #$55
.inloop
    dex
    bne .inloop
    nop
    jmp .nomorerow

.moverow
    ldx #$00
.moverowloop
    lda $0401+$14*0,x
    sta $0400+$14*0,x
    lda $0401+$14*1,x
    sta $0400+$14*1,x
    inx
    cpx #$14
    bne .moverowloop

.nomorerow
    nop

    iny
    cpy #$10
    bne .outloop

    nop
    nop

    lda #$00
    sta $d020

    lda $ff
    ldx #$00
.sineupdateloop
    adc #$05
    tay

    pha
    lda sinewave,y
    sta linelocations,x
    pla

    inx
    cpx #$19
    bne .sineupdateloop

    lda $ff
    and #$7f
    tay
    ldx #$00
.colorupdateloop
    lda colorwave,y
    sta linecolors,x
    iny
    inx
    cpx #$19
    bne .colorupdateloop

    inc $ff

    jsr music+3
 
    rti

linelocations
    db $00,$01,$02,$03,$04,$05,$06,$07,$08,$09,$0a,$0b,$0c,$0d,$0e,$0f
    db $00,$01,$02,$03,$04,$05,$06,$07,$08,$09,$0a,$0b,$0c,$0d,$0e,$0f

linecolors
    db $00,$01,$02,$03,$04,$05,$06,$07,$08,$09,$0a,$0b,$0c,$0d,$0e,$0f
    db $00,$01,$02,$03,$04,$05,$06,$07,$08,$09,$0a,$0b,$0c,$0d,$0e,$0f

sinewave
    db $00,$01,$02,$03,$04,$05,$06,$07,$07,$07,$07,$07,$07,$07,$07,$07
    db $07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07
    db $07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07
    db $07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07

    db $07,$06,$05,$04,$03,$02,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00
    db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
    db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
    db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00

    db $00,$01,$02,$03,$04,$05,$06,$07,$07,$07,$07,$07,$07,$07,$07,$07
    db $07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07
    db $07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07
    db $07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07

    db $07,$06,$05,$04,$03,$02,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00
    db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
    db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
    db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00

colorwave
    db $00,$0b,$00,$0b,$0b,$0c,$0b,$0c,$0c,$0f,$0c,$0f,$0f,$01,$0f,$01
    db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
    db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
    db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01

    db $01,$0f,$01,$0f,$0f,$0c,$0f,$0c,$0c,$0b,$0c,$0b,$0b,$00,$0b,$00
    db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
    db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
    db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00

    db $00,$0b,$00,$0b,$0b,$0c,$0b,$0c,$0c,$0f,$0c,$0f,$0f,$01,$0f,$01
    db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
    db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
    db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01

    db $01,$0f,$01,$0f,$0f,$0c,$0f,$0c,$0c,$0b,$0c,$0b,$0b,$00,$0b,$00
    db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
    db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
    db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00

logo
    text "ramalamadingdong 2022"

	org $1000
music
	incbin "Fungus.dat",2
